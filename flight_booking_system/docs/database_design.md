# تصميم مخطط قاعدة البيانات لنظام حجز تذاكر الطيران

## مقدمة

بناءً على دراسة قاعدة بيانات mustafakk الحالية والمتطلبات الجديدة، قمت بتصميم مخطط قاعدة بيانات معزز لنظام حجز تذاكر الطيران. يتضمن المخطط الجديد المزيد من شركات الطيران وأسعار متغيرة للرحلات حسب الشركة، بالإضافة إلى العديد من التحسينات الأخرى.

## تحليل قاعدة البيانات الحالية

قاعدة بيانات mustafakk الحالية تتكون من الجداول التالية:

1. **airlines**: يحتوي على معلومات شركات الطيران (الاسم فقط)
2. **cities**: يحتوي على معلومات المدن (الاسم فقط)
3. **flight_schedules**: يحتوي على جداول الرحلات (شركة الطيران، المدينة المصدر، المدينة الوجهة، يوم الأسبوع، وقت المغادرة، وقت الوصول)
4. **flight_prices**: يحتوي على أسعار الرحلات (المدينة المصدر، المدينة الوجهة، السعر)
5. **bookings**: يحتوي على معلومات الحجوزات (اسم المسافر، رقم الرحلة، درجة السفر، عدد الحقائب، خصم طبي، السعر النهائي، تاريخ الحجز)

## التحسينات في المخطط الجديد

قمت بإجراء التحسينات التالية على مخطط قاعدة البيانات:

1. **إضافة المزيد من شركات الطيران**: زيادة عدد شركات الطيران من 7 إلى 15 شركة طيران مختلفة.

2. **أسعار متغيرة حسب شركة الطيران**: تعديل جدول `flight_prices` ليشمل معرف شركة الطيران، مما يسمح بتحديد أسعار مختلفة لنفس المسار حسب الشركة.

3. **إضافة فئات الحجز**: إنشاء جدول `travel_classes` لتخزين فئات الحجز المختلفة (اقتصادية، رجال أعمال، درجة أولى).

4. **تحسين هيكل الأسعار**: إضافة حقول للسعر الأساسي، نسبة الضريبة، ونسبة الخصم لحساب السعر النهائي بشكل أكثر دقة.

5. **إضافة الخدمات الإضافية**: إنشاء جداول للخدمات الإضافية وأسعارها حسب شركة الطيران.

6. **إدارة المستخدمين**: إضافة جدول للمستخدمين لتسجيل الحسابات وإدارة الملفات الشخصية.

7. **تحسين نظام الحجز**: تحسين جدول الحجوزات ليشمل معلومات أكثر تفصيلاً وحالات مختلفة للحجز.

8. **إضافة نظام المدفوعات**: إنشاء جدول للمدفوعات لتتبع عمليات الدفع المرتبطة بالحجوزات.

## هيكل قاعدة البيانات الجديد

### 1. جدول المدن (cities)
- id: معرف المدينة
- name: اسم المدينة
- country: اسم الدولة
- airport_code: رمز المطار

### 2. جدول شركات الطيران (airlines)
- id: معرف شركة الطيران
- name: اسم شركة الطيران
- code: رمز شركة الطيران
- logo: شعار شركة الطيران
- description: وصف شركة الطيران
- rating: تقييم شركة الطيران

### 3. جدول فئات الحجز (travel_classes)
- id: معرف فئة الحجز
- name: اسم فئة الحجز
- description: وصف فئة الحجز

### 4. جدول جداول الرحلات (flight_schedules)
- id: معرف الرحلة
- airline_id: معرف شركة الطيران
- flight_number: رقم الرحلة
- from_city_id: معرف مدينة المغادرة
- to_city_id: معرف مدينة الوصول
- day_of_week: يوم الأسبوع
- departure_time: وقت المغادرة
- arrival_time: وقت الوصول
- aircraft_type: نوع الطائرة
- status: حالة الرحلة

### 5. جدول أسعار الرحلات (flight_prices)
- id: معرف السعر
- airline_id: معرف شركة الطيران
- from_city_id: معرف مدينة المغادرة
- to_city_id: معرف مدينة الوصول
- travel_class_id: معرف فئة الحجز
- base_price: السعر الأساسي
- tax_percentage: نسبة الضريبة
- discount_percentage: نسبة الخصم
- currency: العملة

### 6. جدول المستخدمين (users)
- id: معرف المستخدم
- username: اسم المستخدم
- password: كلمة المرور
- email: البريد الإلكتروني
- first_name: الاسم الأول
- last_name: اسم العائلة
- phone: رقم الهاتف
- address: العنوان
- date_of_birth: تاريخ الميلاد
- passport_number: رقم جواز السفر
- passport_expiry: تاريخ انتهاء جواز السفر
- nationality: الجنسية
- created_at: تاريخ الإنشاء
- updated_at: تاريخ التحديث

### 7. جدول الحجوزات (bookings)
- id: معرف الحجز
- booking_reference: رقم مرجع الحجز
- user_id: معرف المستخدم
- passenger_name: اسم المسافر
- passenger_email: البريد الإلكتروني للمسافر
- passenger_phone: رقم هاتف المسافر
- flight_schedule_id: معرف جدول الرحلة
- travel_class_id: معرف فئة الحجز
- booking_date: تاريخ الحجز
- flight_date: تاريخ الرحلة
- seat_number: رقم المقعد
- bags_count: عدد الحقائب
- medical_discount: خصم طبي
- base_price: السعر الأساسي
- tax_amount: مبلغ الضريبة
- discount_amount: مبلغ الخصم
- final_price: السعر النهائي
- payment_status: حالة الدفع
- booking_status: حالة الحجز

### 8. جدول الخدمات الإضافية (ancillary_services)
- id: معرف الخدمة
- name: اسم الخدمة
- description: وصف الخدمة

### 9. جدول أسعار الخدمات الإضافية حسب شركة الطيران (airline_ancillary_prices)
- id: معرف السعر
- airline_id: معرف شركة الطيران
- ancillary_service_id: معرف الخدمة الإضافية
- price: السعر
- currency: العملة

### 10. جدول الخدمات الإضافية المحجوزة (booking_ancillaries)
- id: معرف الحجز الإضافي
- booking_id: معرف الحجز
- ancillary_service_id: معرف الخدمة الإضافية
- price: السعر

### 11. جدول المدفوعات (payments)
- id: معرف الدفع
- booking_id: معرف الحجز
- amount: المبلغ
- payment_method: طريقة الدفع
- transaction_id: معرف المعاملة
- payment_date: تاريخ الدفع
- status: حالة الدفع

## البيانات الأولية

قمت بإضافة بيانات أولية لجميع الجداول، بما في ذلك:

1. **المدن**: 20 مدينة من مختلف أنحاء العالم مع رموز المطارات.
2. **شركات الطيران**: 15 شركة طيران مختلفة مع معلومات تفصيلية.
3. **فئات الحجز**: الدرجة الاقتصادية، درجة رجال الأعمال، الدرجة الأولى.
4. **الخدمات الإضافية**: 8 خدمات إضافية مختلفة.
5. **أسعار الخدمات الإضافية**: أسعار مختلفة حسب شركة الطيران.
6. **جداول الرحلات**: رحلات متنوعة بين المدن المختلفة.
7. **أسعار الرحلات**: أسعار مختلفة حسب شركة الطيران وفئة الحجز.

## الخلاصة

يوفر مخطط قاعدة البيانات الجديد هيكلاً أكثر شمولاً وتفصيلاً لنظام حجز تذاكر الطيران. يتضمن المخطط المزيد من شركات الطيران وأسعار متغيرة للرحلات حسب الشركة، بالإضافة إلى العديد من التحسينات الأخرى التي تجعل النظام أكثر مرونة وقابلية للتوسع.
